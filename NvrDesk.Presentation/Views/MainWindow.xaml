<Window x:Class="NvrDesk.Presentation.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:NvrDesk.Presentation.ViewModels"
        xmlns:controls="clr-namespace:NvrDesk.Presentation.Controls"
        mc:Ignorable="d"
        Title="NVR Desk" Height="900" Width="1400">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
            <Button Content="Actualizar" Command="{Binding RefreshCommand}" Margin="0,0,8,0" Width="110" />
            <Button Content="Agregar NVR" Command="{Binding AddNvrCommand}" Margin="0,0,8,0" Width="130" />
            <Button Content="Sincronizar canales" Command="{Binding SyncSelectedNvrChannelsCommand}" Width="160" />
        </StackPanel>

        <TabControl Grid.Row="1">
            <TabItem Header="NVRs">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <DataGrid ItemsSource="{Binding Nvrs}" SelectedItem="{Binding SelectedNvr}" AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Nombre" Binding="{Binding Name}" />
                            <DataGridTextColumn Header="Marca" Binding="{Binding Brand}" />
                            <DataGridTextColumn Header="Host" Binding="{Binding Host}" />
                            <DataGridTextColumn Header="HTTP" Binding="{Binding HttpPort}" />
                            <DataGridTextColumn Header="RTSP" Binding="{Binding RtspPort}" />
                            <DataGridTextColumn Header="Usuario" Binding="{Binding Username}" />
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Column="1" Margin="10,0,0,0">
                        <Button Content="Probar conexi칩n" Command="{Binding TestSelectedNvrCommand}" Margin="0,0,0,8" Height="36" />
                        <Button Content="Eliminar" Command="{Binding DeleteSelectedNvrCommand}" Height="36" />
                        <TextBlock Text="{Binding StatusMessage}" Margin="0,12,0,0" TextWrapping="Wrap"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <TabItem Header="C치maras">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBlock Text="Dise침o:" VerticalAlignment="Center" Margin="0,0,6,0" />
                        <ComboBox Width="80" SelectedValue="{Binding CameraGridSize}" SelectedValuePath="Tag">
                            <ComboBoxItem Content="1" Tag="1" />
                            <ComboBoxItem Content="4" Tag="4" />
                            <ComboBoxItem Content="9" Tag="9" />
                            <ComboBoxItem Content="16" Tag="16" />
                        </ComboBox>
                    </StackPanel>
                    <ItemsControl Grid.Row="1" ItemsSource="{Binding CameraCells}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <UniformGrid Columns="{Binding GridColumns}" Rows="{Binding GridRows}"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate DataType="{x:Type vm:CameraCellViewModel}">
                                <controls:VideoCellControl />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>
            </TabItem>

            <TabItem Header="Grabaciones">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="2*" />
                    </Grid.RowDefinitions>

                    <WrapPanel Margin="0,0,0,8">
                        <TextBlock Text="C치mara" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <ComboBox Width="260" ItemsSource="{Binding Channels}" SelectedItem="{Binding SelectedPlaybackChannel}" DisplayMemberPath="DisplayName" />
                        <TextBlock Text="Inicio" Margin="14,0,6,0" VerticalAlignment="Center"/>
                        <DatePicker SelectedDate="{Binding PlaybackStartDate}" Width="130"/>
                        <TextBox Text="{Binding PlaybackStartTime}" Width="80" Margin="6,0,0,0"/>
                        <TextBlock Text="Fin" Margin="14,0,6,0" VerticalAlignment="Center"/>
                        <DatePicker SelectedDate="{Binding PlaybackEndDate}" Width="130"/>
                        <TextBox Text="{Binding PlaybackEndTime}" Width="80" Margin="6,0,0,0"/>
                        <Button Content="Buscar" Command="{Binding SearchRecordingsCommand}" Width="90" Margin="12,0,0,0"/>
                        <Button Content="Reproducir" Command="{Binding PlayRecordingCommand}" Width="100" Margin="8,0,0,0"/>
                    </WrapPanel>

                    <DataGrid Grid.Row="1" ItemsSource="{Binding RecordingSegments}" AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Inicio (UTC)" Binding="{Binding StartUtc}" />
                            <DataGridTextColumn Header="Fin (UTC)" Binding="{Binding EndUtc}" />
                            <DataGridTextColumn Header="Calidad" Binding="{Binding Quality}" />
                            <DataGridTextColumn Header="Notas" Binding="{Binding Notes}" Width="*" />
                        </DataGrid.Columns>
                    </DataGrid>

                    <controls:VideoCellControl Grid.Row="2" DataContext="{Binding PlaybackCell}" />
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
